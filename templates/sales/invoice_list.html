{% extends "base.html" %}
{% block title %}Invoice List{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-4">Invoice List</h2>

<form method="get" class="mb-4 flex gap-2">
  <input name="q_name" placeholder="Search by Name ..." class="input input-bordered" value="{{ request.GET.q_name }}">
  <input name="q_invoice" placeholder="Search by Invoice No ..." class="input input-bordered" value="{{ request.GET.q_invoice }}">
  <input name="q_date" type="date" class="input input-bordered" value="{{ request.GET.q_date }}">
  <button class="btn btn-primary">Search</button>
</form>

<div class="card bg-base-100 shadow">
  <div class="overflow-x-auto">
    <table class="table w-full">
      <thead>
        <tr>
          <th>Date</th><th>Invoice</th><th>Customer</th><th>Payment</th><th>Installment</th><th>Quantity</th><th>Sub Total</th><th>Grand Total</th><th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for inv in invoices %}
        <tr>
          <td>{{ inv.date|date:"M. d, Y" }}</td>
          <td>{{ inv }}</td>
          <td>
  {% if inv.customer %}
    {{ inv.customer.name }}
  {% else %}
    -
  {% endif %}
</td>

          <td>{{ inv.payment_type }}</td>
          <td>
            {% if inv.has_installment %}
              <span class="text-green-600">âœ”</span>
            {% else %}
              -
            {% endif %}
          </td>
          <td>{{ inv.total_quantity }}</td>
          <td>{{ inv.sub_total }}</td>
          <td>{{ inv.grand_total }}</td>
          <td>
            <a class="btn btn-sm btn-info" href="{% url 'sales:invoice_detail' inv.id %}">View</a>
            <a class="btn btn-sm btn-warning" href="{% url 'sales:installment_list' inv.id %}">Installments</a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="9" class="text-center py-8">No invoices.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div class="mt-4">
  {% if invoices.has_other_pages %}
    <div class="btn-group">
      {% if invoices.has_previous %}<a class="btn" href="?page={{ invoices.previous_page_number }}">Prev</a>{% endif %}
      <span class="btn">Page {{ invoices.number }} of {{ invoices.paginator.num_pages }}</span>
      {% if invoices.has_next %}<a class="btn" href="?page={{ invoices.next_page_number }}">Next</a>{% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}
